# Repository Guidelines

## Project Structure & Module Organization
The Next.js app lives inside `src`: `components` holds landing sections plus shared widgets (tests live in `components/__tests__`), `pages` exposes routes, and `lib` collects data helpers. Tailwind configuration sits in `src/styles`, while long-form copy is authored in `/posts` and serialized metadata lands in `/data`. Static assets and legal PDFs belong in `/public`. Database schema, seeds, and SQL helpers reside in `/supabase`, and automation scripts stay in `/scripts`.

## Build, Test & Development Commands
Install once with `npm install` (Node ≥18). Use `npm run dev` for the local server on :3000, `npm run build` + `npm start` for production verification, and `npm run lint` before every PR. `npm run test` chains Jest and the booking pricing smoke test; run `node scripts/test-pricing-calculation.js` alone when debugging totals. Reset Supabase with `npx supabase db reset` and mirror auth identities via `node scripts/seed-auth-users.js`.

## Coding Style & Naming Conventions
Components are TypeScript functions written with 2-space indentation and PascalCase filenames (`SafetyTrustSection.tsx`). Share hooks through named exports in `src/lib`. Keep Tailwind class lists grouped roughly by layout → spacing → typography to minimize merge churn. Let ESLint/Prettier drive formatting—avoid manual tweaks that fight the config. Secrets stay in `.env.local`; reference them through `process.env`.

## Testing Guidelines
Unit tests rely on Jest + Testing Library and follow the `Component.test.tsx` pattern inside `src/components/__tests__`. Prefer behavior assertions (text, aria roles, button clicks) over snapshots, and stub Supabase, Nodemailer, or fetch-heavy modules. Any booking, pricing, or acceptance change must rerun `scripts/test-pricing-calculation.js` after seeding to confirm totals. Document gaps whenever a feature cannot be exercised locally.

## Commit & Pull Request Guidelines
History favors imperative subject lines plus linked issue IDs (example: `Add Safety & Trust section to landing page (#15)`). Keep commits focused, bundling schema or script edits with the feature they support. Pull requests should list the change summary, testing evidence (`npm run lint`, `npm run test`), screenshots or GIFs for UI updates, and call out config prerequisites when relevant.

## Security & Configuration Tips
Audit `.env.local` before pushing to ensure SMTP, Supabase, and AWS keys never leak. Use throwaway accounts generated by the seeding scripts when demoing flows. Non-marketing binaries should remain out of Git—upload through the S3 helper instead. After adding or renaming routes, rerun `npm run postbuild` (sitemap) so search metadata reflects the new structure.
